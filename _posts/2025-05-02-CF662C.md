---
layout: post
title: "CF662C Binary Table 题解"
tags: Codeforces 题解
---

将列的状态作为 bitmask $i$，记 $a_i$ 表示状态为 $i$ 的列的出现次数，$\operatorname{pop}(i)=\min(\operatorname{popcount}(i),n-\operatorname{popcount}(i))$。

枚举行的翻转状态为 bitmask $k$。记行的翻转状态为 $k$ 时，$1$ 的数量为 $f(k)$，那么最终答案就是

$$
\min_{k\in[0,1]^n}f(k)
$$

其中

$$
f(k)=\sum_{i\in[0,1]^n}a_i\times\operatorname{pop}(i\oplus k)
$$

换元，令 $j=i\oplus k$，则 $i\oplus j=k$

$$
\begin{aligned}
f(k)&=\sum_{i\in[0,1]^n}a_i\times\operatorname{pop}(i\oplus k)\\
&=\sum_{i\oplus j=k}a_i\times\operatorname{pop}(j)\\
\end{aligned}
$$

预处理出 $a,\operatorname{pop}$ 后 FWT 处理出 $f$ 即可，复杂度瓶颈来源于 FWT，为 $\mathcal O(n2^n)$。